<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MONTBLOCK â€“ Block Factory Manager</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;margin:0;background:#f4f4f4}
header{background:#000;color:#fff;padding:15px;text-align:center;font-weight:bold}
nav{display:flex;justify-content:space-around;background:#e0e0e0;padding:10px;flex-wrap:wrap}
nav button{padding:10px;border:none;background:#000;color:#fff;border-radius:4px;margin:3px}
section{padding:15px}
.card{background:#fff;padding:12px;margin-bottom:12px;border-radius:6px}
input,select{width:100%;padding:8px;margin:6px 0}
h3{margin-top:0}
.small{color:#666;font-size:14px}
.edit{background:#777}
</style>
</head>

<body>

<header>MONTBLOCK â€“ Block Factory Manager</header>

<nav>
<button onclick="show('dash')">Dashboard</button>
<button onclick="show('prod')">Production</button>
<button onclick="show('sale')">Sales</button>
<button onclick="show('cement')">Cement</button>
<button onclick="show('exp')">Expenses</button>
</nav>

<section id="dash" class="card"></section>

<section id="prod" class="card" style="display:none">
<h3>Production</h3>
<select id="psize">
<option value="4">4 inch</option>
<option value="5">5 inch</option>
<option value="6">6 inch</option>
</select>
<input id="pqty" type="number" placeholder="Quantity produced">
<button onclick="addProd()">Save Production</button>
</section>

<section id="sale" class="card" style="display:none">
<h3>Sales</h3>
<select id="ssize">
<option value="4">4 inch</option>
<option value="5">5 inch</option>
<option value="6">6 inch</option>
</select>
<input id="sqty" type="number" placeholder="Quantity sold">
<input id="sprice" type="number" placeholder="Price per block (TZS)">
<button onclick="addSale()">Save Sale</button>
<button class="edit" onclick="editSale()">Edit Last Sale</button>
</section>

<section id="cement" class="card" style="display:none">
<h3>ğŸ—ï¸ Cement Purchase</h3>
<input id="cbags" type="number" placeholder="Bags purchased">
<input id="cprice" type="number" placeholder="Price per bag (TZS)">
<button onclick="addCement()">Save Cement</button>
<button class="edit" onclick="editCement()">Edit Last Cement</button>
</section>

<section id="exp" class="card" style="display:none">
<h3>Other Expenses</h3>
<input id="eamt" type="number" placeholder="Amount (TZS)">
<button onclick="addExp()">Save Expense</button>
<button class="edit" onclick="editExp()">Edit Last Expense</button>
</section>

<script>
let data = JSON.parse(localStorage.getItem("montblock")) || {
stock:{4:0,5:0,6:0},
cementBags:0,
sales:0,
expenses:0,
last:{cement:null, sale:null, exp:null}
};

function fmt(n){return Number(n).toLocaleString("en-US");}

function save(){
localStorage.setItem("montblock", JSON.stringify(data));
dashboard();
}

function show(id){
["dash","prod","sale","cement","exp"].forEach(s=>document.getElementById(s).style.display="none");
document.getElementById(id).style.display="block";
}

function dashboard(){
document.getElementById("dash").innerHTML = `
<h3>Dashboard</h3>
<p><b>ğŸ—ï¸ Cement Stock:</b> ${data.cementBags} bags</p>
<hr>
<p>ğŸ§± 4â€ Blocks: <b>${data.stock[4]}</b></p>
<p>ğŸ§± 5â€ Blocks: <b>${data.stock[5]}</b></p>
<p>ğŸ§± 6â€ Blocks: <b>${data.stock[6]}</b></p>
<hr>
<p>ğŸ’° Sales: <b>TZS ${fmt(data.sales)}</b></p>
<p>ğŸ’¸ Expenses: <b>TZS ${fmt(data.expenses)}</b></p>
<p><b>ğŸ“ˆ Profit: TZS ${fmt(data.sales - data.expenses)}</b></p>
`;
}

function addProd(){
let s=psize.value,q=Number(pqty.value);
if(q>0){data.stock[s]+=q;save();pqty.value="";}
}

function addSale(){
let s=ssize.value,q=Number(sqty.value),p=Number(sprice.value);
if(data.stock[s]<q){alert("Not enough stock");return;}
data.stock[s]-=q;
let total=q*p;
data.sales+=total;
data.last.sale={s,q,p,total};
save();sqty.value="";sprice.value="";
}

function editSale(){
if(!data.last.sale){alert("No sale to edit");return;}
let n=prompt("Enter NEW total sale amount",data.last.sale.total);
if(!n)return;
data.sales-=data.last.sale.total;
data.sales+=Number(n);
data.last.sale.total=Number(n);
save();
}

function addCement(){
let b=Number(cbags.value),p=Number(cprice.value);
if(b<=0||p<=0)return;
let total=b*p;
data.cementBags+=b;
data.expenses+=total;
data.last.cement={b,total};
save();cbags.value="";cprice.value="";
}

function editCement(){
if(!data.last.cement){alert("No cement entry");return;}
let n=prompt("Enter NEW number of bags",data.last.cement.b);
if(!n)return;
data.cementBags-=data.last.cement.b;
data.cementBags+=Number(n);
data.expenses-=data.last.cement.total;
data.expenses+=Number(n)*(data.last.cement.total/data.last.cement.b);
data.last.cement.b=Number(n);
save();
}

function addExp(){
let a=Number(eamt.value);
if(a>0){
data.expenses+=a;
data.last.exp={a};
save();eamt.value="";
}
}

function editExp(){
if(!data.last.exp){alert("No expense to edit");return;}
let n=prompt("Enter NEW expense amount",data.last.exp.a);
if(!n)return;
data.expenses-=data.last.exp.a;
data.expenses+=Number(n);
data.last.exp.a=Number(n);
save();
}

dashboard();
</script>

</body>
</html>
