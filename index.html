<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MONTBLOCK â€“ Block Factory Manager</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;margin:0;background:#f4f4f4}
header{background:#000;color:#fff;padding:15px;text-align:center;font-weight:bold}
nav{display:flex;justify-content:space-around;background:#e0e0e0;padding:10px;flex-wrap:wrap}
nav button{padding:10px;border:none;background:#000;color:#fff;border-radius:4px;margin:3px}
section{padding:15px}
.card{background:#fff;padding:12px;margin-bottom:12px;border-radius:6px}
input,select{width:100%;padding:8px;margin:6px 0}
h3{margin-top:0}
.small{color:#666;font-size:14px}
</style>
</head>

<body>

<header>MONTBLOCK â€“ Block Factory Manager</header>

<nav>
<button onclick="show('dash')">Dashboard</button>
<button onclick="show('prod')">Production</button>
<button onclick="show('sale')">Sales</button>
<button onclick="show('cement')">Cement</button>
<button onclick="show('exp')">Expenses</button>
</nav>

<section id="dash" class="card"></section>

<section id="prod" class="card" style="display:none">
<h3>Production</h3>
<select id="psize">
<option value="4">4 inch</option>
<option value="5">5 inch</option>
<option value="6">6 inch</option>
</select>
<input id="pqty" type="number" placeholder="Quantity produced">
<button onclick="addProd()">Save Production</button>
</section>

<section id="sale" class="card" style="display:none">
<h3>Sales</h3>
<select id="ssize">
<option value="4">4 inch</option>
<option value="5">5 inch</option>
<option value="6">6 inch</option>
</select>
<input id="sqty" type="number" placeholder="Quantity sold">
<input id="sprice" type="number" placeholder="Price per block (TZS)">
<button onclick="addSale()">Save Sale</button>
</section>

<section id="cement" class="card" style="display:none">
<h3>Cement Purchase</h3>
<input id="cbags" type="number" placeholder="Bags purchased">
<input id="cprice" type="number" placeholder="Price per bag (TZS)">
<p class="small">Total: TZS <span id="ctotal">0</span></p>
<button onclick="addCement()">Save Cement Purchase</button>
</section>

<section id="exp" class="card" style="display:none">
<h3>Other Expenses (Sand, Labour, Transport)</h3>
<input id="etype" placeholder="Expense type">
<input id="eamt" type="number" placeholder="Total amount (TZS)">
<button onclick="addExp()">Save Expense</button>
</section>

<script>
let data = JSON.parse(localStorage.getItem("montblock")) || {
stock:{4:0,5:0,6:0},
cementBags:0,
sales:0,
expenses:0
};

function fmt(n){
  return Number(n).toLocaleString("en-US");
}

function save(){
  localStorage.setItem("montblock", JSON.stringify(data));
  dashboard();
}

function show(id){
  ["dash","prod","sale","cement","exp"].forEach(s=>{
    document.getElementById(s).style.display="none";
  });
  document.getElementById(id).style.display="block";
}

function dashboard(){
  let cementKg = data.cementBags * 50;
  document.getElementById("dash").innerHTML = `
  <h3>Dashboard</h3>

  <p><b>Cement Stock</b><br>
  ğŸ§± ${data.cementBags} bags<br>
  âš–ï¸ ${fmt(cementKg)} kg
  </p>

  <hr>

  <p>ğŸ§± 4â€ Blocks: <b>${data.stock[4]}</b></p>
  <p>ğŸ§± 5â€ Blocks: <b>${data.stock[5]}</b></p>
  <p>ğŸ§± 6â€ Blocks: <b>${data.stock[6]}</b></p>

  <hr>

  <p>ğŸ’° Total Sales: <b>TZS ${fmt(data.sales)}</b></p>
  <p>ğŸ’¸ Total Expenses: <b>TZS ${fmt(data.expenses)}</b></p>
  <p><b>ğŸ“ˆ Profit: TZS ${fmt(data.sales - data.expenses)}</b></p>
  `;
}

function addProd(){
  let s = psize.value;
  let q = Number(pqty.value);
  if(q>0){
    data.stock[s]+=q;
    save();
    alert("Production saved");
    pqty.value="";
  }
}

function addSale(){
  let s = ssize.value;
  let q = Number(sqty.value);
  let p = Number(sprice.value);
  if(data.stock[s] < q){
    alert("Not enough stock");
    return;
  }
  data.stock[s]-=q;
  data.sales += q*p;
  save();
  alert("Sale saved");
  sqty.value=""; 
  sprice.value="";
}

function addCement(){
  let bags = Number(cbags.value);
  let price = Number(cprice.value);
  if(bags<=0 || price<=0){
    alert("Enter bags and price per bag");
    return;
  }
  let total = bags * price;
  data.cementBags += bags;
  data.expenses += total;
  save();
  alert("Cement purchase saved");
  cbags.value=""; 
  cprice.value="";
  document.getElementById("ctotal").innerText = "0";
}

function addExp(){
  let amt = Number(eamt.value);
  if(amt>0){
    data.expenses += amt;
    save();
    alert("Expense saved");
    etype.value=""; 
    eamt.value="";
  }
}

document.getElementById("cement").addEventListener("input", ()=>{
  let bags = Number(cbags.value);
  let price = Number(cprice.value);
  document.getElementById("ctotal").innerText = fmt(bags*price || 0);
});

dashboard();
</script>

</body>
</html>
