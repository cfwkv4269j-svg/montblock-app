<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MONTBLOCK – Factory System</title>

<style>
body{font-family:Arial;margin:0;background:#f4f4f4}
header{background:#000;color:#fff;padding:15px;text-align:center;font-weight:bold}
nav{display:flex;flex-wrap:wrap;justify-content:space-around;background:#ddd;padding:10px}
nav button{padding:10px;border:none;background:#000;color:#fff;border-radius:4px;margin:3px}
section{display:none;padding:15px}
.card{background:#fff;padding:15px;border-radius:6px}
input,select{width:100%;padding:8px;margin:6px 0}
hr{margin:15px 0}
.sellBtn{background:#0a7d0a}
.expBtn{background:#b00020}
</style>
</head>

<body>

<header>MONTBLOCK – Factory System</header>

<nav>
<button onclick="show('dash')">Dashboard</button>
<button onclick="show('cement')">Cement</button>
<button onclick="show('prod')">Production</button>
<button onclick="show('sales')">Sales</button>
<button onclick="show('exp')">Expenses</button>
</nav>

<section id="dash" class="card">
<h3>Dashboard</h3>

<p><b>Cement Stock:</b> <span id="cementStock">0</span> bags</p>

<hr>

<p><b>4″ Blocks:</b> <span id="b4">0</span></p>
<p><b>5″ Blocks:</b> <span id="b5">0</span></p>
<p><b>6″ Blocks:</b> <span id="b6">0</span></p>

<hr>

<p><b>Total Sales:</b> TZS <span id="totalSales">0</span></p>
<p><b>Total Expenses:</b> TZS <span id="totalExpenses">0</span></p>

<hr>

<p><b>PROFIT:</b> TZS <span id="profit">0</span></p>
</section>

<section id="cement" class="card">
<h3>Cement IN</h3>
<input type="number" id="inBags" placeholder="Bags purchased">
<input type="number" id="inPrice" placeholder="Price per bag">
<button onclick="cementIn()">Save Cement IN</button>

<hr>

<h3>Cement OUT</h3>
<input type="number" id="outBags" placeholder="Bags used">
<button onclick="cementOut()">Save Cement OUT</button>
</section>

<section id="prod" class="card">
<h3>Block Production</h3>

<select id="pSize">
<option value="4">4 inch blocks</option>
<option value="5">5 inch blocks</option>
<option value="6">6 inch blocks</option>
</select>

<input type="number" id="pQty" placeholder="Quantity produced">
<button onclick="saveProduction()">Save Production</button>
</section>

<section id="sales" class="card">
<h3>SELL BLOCKS</h3>

<select id="sSize">
<option value="4">4 inch blocks</option>
<option value="5">5 inch blocks</option>
<option value="6">6 inch blocks</option>
</select>

<input type="number" id="sQty" placeholder="Quantity sold">
<input type="number" id="sPrice" placeholder="Price per block">

<button class="sellBtn" onclick="sellBlocks()">SELL BLOCKS</button>
</section>

<section id="exp" class="card">
<h3>Expenses</h3>

<input id="expName" placeholder="Expense name (e.g. Labour)">
<input type="number" id="expAmount" placeholder="Amount">

<button class="expBtn" onclick="saveExpense()">Save Expense</button>
</section>

<script>
let store = JSON.parse(localStorage.getItem("montblock_factory_v4")) || {
  cementIn: [],
  cementOut: [],
  production: [],
  sales: [],
  expenses: []
};

function show(id){
  document.querySelectorAll("section").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
}

function save(){
  localStorage.setItem("montblock_factory_v4", JSON.stringify(store));
  updateDashboard();
}

function cementIn(){
  let bags = Number(inBags.value);
  let price = Number(inPrice.value);
  if(bags<=0 || price<=0){ alert("Enter valid numbers"); return; }

  store.cementIn.push({bags,price,time:new Date().toLocaleString()});
  inBags.value=""; inPrice.value="";
  save();
}

function cementOut(){
  let bags = Number(outBags.value);
  if(bags<=0){ alert("Enter valid bags"); return; }

  store.cementOut.push({bags,time:new Date().toLocaleString()});
  outBags.value="";
  save();
}

function saveProduction(){
  let size = pSize.value;
  let qty = Number(pQty.value);
  if(qty<=0){ alert("Enter valid quantity"); return; }

  store.production.push({size,qty,time:new Date().toLocaleString()});
  pQty.value="";
  save();
}

function sellBlocks(){
  let size = sSize.value;
  let qty = Number(sQty.value);
  let price = Number(sPrice.value);

  if(qty<=0 || price<=0){
    alert("Enter valid sale values");
    return;
  }

  store.sales.push({
    size,
    qty,
    price,
    total: qty * price,
    time: new Date().toLocaleString()
  });

  sQty.value="";
  sPrice.value="";
  save();
}

function saveExpense(){
  let name = expName.value.trim();
  let amt = Number(expAmount.value);

  if(name=="" || amt<=0){
    alert("Enter valid expense");
    return;
  }

  store.expenses.push({
    name,
    amt,
    time: new Date().toLocaleString()
  });

  expName.value="";
  expAmount.value="";
  save();
}

function updateDashboard(){
  let cin=0, cout=0;
  store.cementIn.forEach(c=>cin+=c.bags);
  store.cementOut.forEach(c=>cout+=c.bags);
  cementStock.innerText = cin - cout;

  let b4=0,b5=0,b6=0;
  store.production.forEach(p=>{
    if(p.size=="4") b4+=p.qty;
    if(p.size=="5") b5+=p.qty;
    if(p.size=="6") b6+=p.qty;
  });
  store.sales.forEach(s=>{
    if(s.size=="4") b4-=s.qty;
    if(s.size=="5") b5-=s.qty;
    if(s.size=="6") b6-=s.qty;
  });

  b4.innerText=b4;
  b5.innerText=b5;
  b6.innerText=b6;

  let salesTotal = 0;
  store.sales.forEach(s=>salesTotal+=s.total);
  totalSales.innerText = salesTotal.toLocaleString();

  let expTotal = 0;
  store.expenses.forEach(e=>expTotal+=e.amt);
  totalExpenses.innerText = expTotal.toLocaleString();

  profit.innerText = (salesTotal - expTotal).toLocaleString();
}

updateDashboard();
show("dash");
</script>

</body>
</html>